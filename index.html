<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Memoria Visual - Gesti√≥n Cl√≠nica</title>
    <style>
        :root { --bg: #0f172a; --card: #1e293b; --accent: #38bdf8; --success: #22c55e; --text: #f8fafc; }
        body { margin: 0; font-family: 'Segoe UI', sans-serif; background: var(--bg); color: var(--text); display: flex; flex-direction: column; align-items: center; min-height: 100vh; overflow: hidden; }
        
        /* Iconos de fondo reforzados */
        .decor-bg { position: fixed; font-size: 12rem; opacity: 0.08; z-index: -1; user-select: none; pointer-events: none; }
        
        /* Pantalla de Identificaci√≥n */
        #login-screen { position: fixed; inset: 0; background: var(--bg); z-index: 1000; display: flex; flex-direction: column; align-items: center; justify-content: center; }
        .input-clinico { padding: 15px; font-size: 1.2rem; border-radius: 10px; border: 2px solid var(--accent); background: #1e293b; color: white; margin-bottom: 20px; text-align: center; width: 280px; }

        /* Botones de acci√≥n (grandes y visibles) */
        .btn { background: var(--accent); color: white; border: none; padding: 18px 35px; border-radius: 12px; cursor: pointer; font-weight: bold; font-size: 1.2rem; transition: 0.3s; margin: 15px; display: inline-block; }
        .btn:hover { transform: scale(1.05); filter: brightness(1.1); box-shadow: 0 0 20px rgba(56, 189, 248, 0.5); }
        .btn-next { background: var(--success) !important; display: none; } /* Verde para "Siguiente" */

        /* Cuadr√≠cula */
        .grid { display: grid; grid-template-columns: repeat(3, 110px); gap: 15px; margin: 20px auto; padding: 20px; background: rgba(255,255,255,0.03); border-radius: 25px; border: 1px solid rgba(255,255,255,0.1); }
        .tile { width: 110px; height: 110px; background: var(--card); border: 2px solid #334155; border-radius: 20px; cursor: pointer; transition: 0.2s; }
        .tile.active { background: var(--accent); border-color: white; box-shadow: 0 0 40px var(--accent); transform: scale(1.1); }

        #game-ui { display: none; text-align: center; margin-top: 20px; }
        h1 { font-size: 3rem; color: var(--accent); margin: 10px 0; }
    </style>
</head>
<body>

    <div class="decor-bg" style="top: 10%; left: 5%;">üëÅÔ∏è</div>
    <div class="decor-bg" style="bottom: 10%; right: 5%;">üß†</div>

    <div id="login-screen">
        <h2 style="color: var(--accent);">Registro de Terapia</h2>
        <input type="text" id="nombrePaciente" class="input-clinico" placeholder="Nombre del Paciente">
        <button class="btn" onclick="entrarAlJuego()">Entrar</button>
    </div>

    <div id="game-ui">
        <h1 id="nivel-txt">Nivel 1</h1>
        <p id="mensaje" style="font-size: 1.2rem; min-height: 1.5em;">Haz clic en el bot√≥n para iniciar</p>

        <div class="grid">
            <div class="tile" onclick="hacerClic(0)"></div>
            <div class="tile" onclick="hacerClic(1)"></div>
            <div class="tile" onclick="hacerClic(2)"></div>
            <div class="tile" onclick="hacerClic(3)"></div>
            <div class="tile" onclick="hacerClic(4)"></div>
            <div class="tile" onclick="hacerClic(5)"></div>
            <div class="tile" onclick="hacerClic(6)"></div>
            <div class="tile" onclick="hacerClic(7)"></div>
            <div class="tile" onclick="hacerClic(8)"></div>
        </div>

        <div id="area-botones">
            <button id="btn-start" class="btn" onclick="lanzarSecuencia()">INICIAR NIVEL</button>
            <button id="btn-next" class="btn btn-next" onclick="irASiguienteNivel()">SIGUIENTE NIVEL ‚û°Ô∏è</button>
        </div>
    </div>

    <script>
        let paciente = "", nivel = 1, secuencia = [], clicksUsuario = [], puedeTocar = false;
        const fichas = document.querySelectorAll('.tile');

        function entrarAlJuego() {
            paciente = document.getElementById('nombrePaciente').value.trim();
            if (paciente.length < 2) return alert("Por favor, ingresa el nombre.");
            document.getElementById('login-screen').style.display = 'none';
            document.getElementById('game-ui').style.display = 'block';
        }

        async function lanzarSecuencia() {
            document.getElementById('btn-start').style.display = 'none';
            document.getElementById('mensaje').innerText = "Memoriza la secuencia...";
            clicksUsuario = []; secuencia = []; puedeTocar = false;
            
            // Generar nivel: Nivel 1 = 3 fichas
            for(let i=0; i < (nivel + 2); i++) {
                secuencia.push(Math.floor(Math.random() * 9));
            }

            // Mostrar secuencia al paciente
            for(let id of secuencia) {
                await new Promise(r => setTimeout(r, 600));
                fichas[id].classList.add('active');
                await new Promise(r => setTimeout(r, 700));
                fichas[id].classList.remove('active');
            }

            puedeTocar = true;
            document.getElementById('mensaje').innerText = "¬°Tu turno!";
        }

        function hacerClic(id) {
            if (!puedeTocar) return;
            
            fichas[id].classList.add('active');
            setTimeout(() => fichas[id].classList.remove('active'), 250);
            clicksUsuario.push(id);

            // Verificar si fall√≥
            if (clicksUsuario[clicksUsuario.length - 1] !== secuencia[clicksUsuario.length - 1]) {
                alert("Error en la secuencia. Volviendo al inicio.");
                resetTerapia();
                return;
            }

            // Verificar si complet√≥ el nivel
            if (clicksUsuario.length === secuencia.length) {
                puedeTocar = false;
                document.getElementById('mensaje').innerText = "¬°Excelente!";
                document.getElementById('btn-next').style.display = 'inline-block';
            }
        }

        function irASiguienteNivel() {
            nivel++;
            document.getElementById('nivel-txt').innerText = "Nivel " + nivel;
            document.getElementById('mensaje').innerText = "Listo para el pr√≥ximo reto.";
            document.getElementById('btn-next').style.display = 'none';
            document.getElementById('btn-start').style.display = 'inline-block';
        }

        function resetTerapia() {
            nivel = 1;
            document.getElementById('nivel-txt').innerText = "Nivel 1";
            document.getElementById('btn-start').style.display = 'inline-block';
            document.getElementById('btn-next').style.display = 'none';
            document.getElementById('mensaje').innerText = "Toca Iniciar para reintentar.";
        }
    </script>
</body>
</html>

